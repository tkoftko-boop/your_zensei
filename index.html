<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ã‚ãªãŸã®å‰ä¸–ãƒ¡ãƒ¼ã‚«ãƒ¼</title>
  <style>
    :root{
      --bg1:#070a18;
      --bg2:#1a0f2e;
      --card:#0f1733cc;
      --stroke:#ffffff22;
      --text:#f6f7ff;
      --muted:#cfd3ffcc;
      --accent:#9b8cff;
      --accent2:#ff7bd1;
      --ok:#36ffd7;
      --danger:#ff5b7a;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, #2a2fff33, transparent 60%),
        radial-gradient(1000px 700px at 80% 30%, #ff4fd833, transparent 55%),
        radial-gradient(900px 700px at 40% 90%, #36ffd733, transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    .wrap{ width:min(980px, 92vw); padding:28px 0; }
    .hero{ text-align:center; margin-bottom:18px; }
    .badge{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 14px; border:1px solid var(--stroke);
      border-radius:999px;
      background:linear-gradient(180deg, #ffffff10, #ffffff06);
      box-shadow: 0 10px 40px #00000044;
      color:var(--muted);
      font-size:13px; letter-spacing:.04em;
      backdrop-filter: blur(10px);
    }
    .title{
      margin:14px 0 8px;
      font-size: clamp(28px, 4vw, 46px);
      line-height:1.1;
      letter-spacing:.02em;
      text-shadow: 0 0 30px #ffffff22;
    }
    .subtitle{
      margin:0 auto;
      max-width:64ch;
      color:var(--muted);
      font-size:14px;
      line-height:1.7;
    }

    .card{
      margin:22px auto 0;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, #ffffff10, #ffffff06), var(--card);
      border-radius:22px;
      box-shadow: 0 24px 90px #00000066;
      backdrop-filter: blur(14px);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(620px 240px at 50% 0%, #9b8cff55, transparent 62%),
        radial-gradient(520px 240px at 20% 100%, #ff7bd155, transparent 62%),
        radial-gradient(520px 280px at 80% 120%, #36ffd733, transparent 62%);
      pointer-events:none;
      opacity:.9;
      filter: blur(12px);
    }
    .cardInner{ position:relative; padding:22px; }

    .grid{
      display:grid; gap:14px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 780px){
      .grid{ grid-template-columns: 1.08fr .92fr; align-items:stretch; }
    }

    .panel{
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:16px;
      background: #0c1330aa;
    }
    .panel h2{
      margin:0 0 10px;
      font-size:16px;
      color:#ffffffdd;
      letter-spacing:.02em;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .smallToggle{
      display:inline-flex; align-items:center; gap:8px;
      color:var(--muted); font-size:12px;
      user-select:none;
    }
    .smallToggle input{ width:18px; height:18px; accent-color: var(--accent); }

    .row{ display:grid; gap:10px; margin-top:10px; }
    .row2{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }

    label{ display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
    input{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid #ffffff22;
      background:#070b1e;
      color:var(--text);
      font-size:16px;
      outline:none;
      transition:.2s ease;
    }
    input:focus{ border-color:#ffffff55; box-shadow:0 0 0 4px #9b8cff22; }

    .actions{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
    button{
      cursor:pointer;
      border:none;
      padding:12px 14px;
      border-radius:14px;
      font-weight:800;
      letter-spacing:.02em;
      font-size:14px;
      transition: transform .08s ease, filter .2s ease;
      user-select:none;
      white-space:nowrap;
    }
    button:active{ transform: translateY(1px) scale(0.99); }

    .btnMain{
      flex: 1 1 180px;
      color:#0b0f1e;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 14px 40px #9b8cff44;
    }
    .btnSub{
      flex: 1 1 140px;
      color:var(--text);
      background: #0a1030;
      border:1px solid #ffffff22;
    }
    .btnGhost{
      flex: 1 1 140px;
      color:#0b0f1e;
      background: linear-gradient(135deg, #36ffd7, #9b8cff);
    }

    .resultBox{ display:grid; gap:10px; min-height: 220px; align-content:start; }
    .result{
      padding:16px;
      border-radius:18px;
      border:1px solid #ffffff22;
      background: linear-gradient(180deg, #ffffff10, #ffffff06);
      position:relative;
      overflow:hidden;
    }
    .result::after{
      content:"";
      position:absolute; inset:-70px;
      background: conic-gradient(from 180deg, #9b8cff00, #9b8cff66, #ff7bd166, #36ffd744, #9b8cff00);
      opacity:.35;
      filter: blur(18px);
      animation: spin 7s linear infinite;
      pointer-events:none;
    }
    @keyframes spin{ from{ transform: rotate(0deg);} to{ transform: rotate(360deg);} }

    /* ãƒã‚ºæ¼”å‡ºï¼šåˆ¤å®šæ™‚ã«ã‚­ãƒ©ãƒƒ */
    .sparkle{
      position:absolute;
      inset:-40px;
      background: radial-gradient(300px 140px at var(--x, 20%) var(--y, 20%), #ffffffaa, transparent 60%);
      mix-blend-mode: overlay;
      opacity:0;
      pointer-events:none;
      transform: rotate(8deg);
      filter: blur(2px);
    }
    .result.pop .sparkle{
      animation: sparkle 700ms ease-out 1;
    }
    @keyframes sparkle{
      0%{ opacity:0; transform: scale(0.98) rotate(8deg); }
      15%{ opacity:.75; }
      70%{ opacity:.25; }
      100%{ opacity:0; transform: scale(1.03) rotate(8deg); }
    }

    .resultText{
      position:relative;
      z-index:1;
      font-size: clamp(18px, 2.6vw, 24px);
      line-height:1.55;
      font-weight:900;
      text-shadow: 0 0 24px #00000066;
      word-break: keep-all;
      min-height: 3.2em;
    }
    .meta{
      position:relative; z-index:1;
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
    }
    .chip{
      border:1px solid #ffffff22;
      padding:6px 10px;
      border-radius:999px;
      background:#00000022;
    }

    .shareBox{
      position:relative; z-index:1;
      display:grid; gap:10px;
      margin-top:12px;
    }
    textarea{
      width:100%;
      min-height:84px;
      resize:vertical;
      padding:12px;
      border-radius:14px;
      border:1px solid #ffffff22;
      background:#070b1e;
      color:var(--text);
      font-size:13px;
      line-height:1.6;
      outline:none;
    }
    textarea:focus{ border-color:#ffffff55; box-shadow:0 0 0 4px #9b8cff22; }

    .miniActions{ display:flex; gap:10px; flex-wrap:wrap; }
    .miniBtn{
      flex: 1 1 140px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid #ffffff22;
      background:#0a1030;
      color:var(--text);
      font-weight:800;
      cursor:pointer;
    }
    .toast{
      margin-top:8px;
      font-size:12px;
      color:#dffef8;
      background:#36ffd722;
      border:1px solid #36ffd755;
      padding:8px 10px;
      border-radius:12px;
      display:none;
    }
    .toast.show{ display:inline-block; }

    .error{
      color:#ffe5ea;
      background:#ff5b7a22;
      border:1px solid #ff5b7a55;
      padding:10px 12px;
      border-radius:14px;
      font-weight:800;
    }

    .history{
      margin-top:12px;
      border-top:1px dashed #ffffff22;
      padding-top:12px;
      color:var(--muted);
      font-size:12px;
      line-height:1.7;
    }
    .history ul{ margin:8px 0 0; padding-left:18px; }
    .footerNote{
      margin:12px 0 0;
      color:var(--muted);
      font-size:12px;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <div class="badge">ğŸŒ€ ã‚ãªãŸã®å‰ä¸–ï½œã‚¹ã‚¯ã‚·ãƒ§æ˜ ãˆãƒ¢ãƒ¼ãƒ‰</div>
      <h1 class="title">ã‚ãªãŸã®å‰ä¸–ãƒ¡ãƒ¼ã‚«ãƒ¼</h1>
      <p class="subtitle">èª•ç”Ÿæ—¥ã®<strong>æœˆ</strong>ã¨<strong>æ—¥</strong>ã‚’å…¥ã‚Œã¦åˆ¤å®šã€‚çµæœã¯<strong>ã‚³ãƒ”ãƒ¼</strong>ã‚„<strong>ã‚·ã‚§ã‚¢</strong>ã§ãã®ã¾ã¾æŠ•ç¨¿ã§ãã¾ã™ã€‚</p>
    </div>

    <div class="card">
      <div class="cardInner">
        <div class="grid">
          <div class="panel">
            <h2>
              å…¥åŠ›
              <label class="smallToggle" title="åŠ¹æœéŸ³ON/OFF">
                <input id="soundToggle" type="checkbox" checked />
                åŠ¹æœéŸ³
              </label>
            </h2>

            <div class="row">
              <div class="row2">
                <div>
                  <label for="month">èª•ç”Ÿæ—¥ï¼ˆæœˆï¼‰</label>
                  <input id="month" type="number" inputmode="numeric" placeholder="ä¾‹ï¼š7" min="1" max="12" />
                </div>
                <div>
                  <label for="day">èª•ç”Ÿæ—¥ï¼ˆæ—¥ï¼‰</label>
                  <input id="day" type="number" inputmode="numeric" placeholder="ä¾‹ï¼š27" min="1" max="31" />
                </div>
              </div>

              <div class="actions">
                <button class="btnMain" id="btnCheck">å‰ä¸–ã‚’ã¿ã‚‹</button>
                <button class="btnGhost" id="btnCopyResult">çµæœã ã‘ã‚³ãƒ”ãƒ¼</button>
                <button class="btnSub" id="btnRandom">ãƒ©ãƒ³ãƒ€ãƒ </button>
                <button class="btnSub" id="btnReset">ãƒªã‚»ãƒƒãƒˆ</button>
              </div>

              <div id="errorBox" style="display:none;" class="error"></div>

              <div class="history">
                <strong>ç›´è¿‘ã®çµæœï¼ˆ5ä»¶ï¼‰</strong>
                <ul id="historyList"></ul>
              </div>
            </div>
          </div>

          <div class="panel resultBox">
            <h2>çµæœ</h2>

            <div class="result" id="resultCard" aria-live="polite">
              <div class="sparkle"></div>
              <div id="resultText" class="resultText">ã“ã“ã«çµæœãŒå‡ºã¾ã™ã€‚</div>
              <div class="meta" id="metaChips" style="display:none;"></div>

              <div class="shareBox" id="shareBox" style="display:none;">
                <label for="shareText" style="margin:6px 0 0;">æŠ•ç¨¿ç”¨ãƒ†ã‚­ã‚¹ãƒˆï¼ˆãã®ã¾ã¾è²¼ã‚Œã‚‹ï¼‰</label>
                <textarea id="shareText" readonly></textarea>

                <div class="miniActions">
                  <button class="miniBtn" id="btnCopyShare">æŠ•ç¨¿æ–‡ã‚³ãƒ”ãƒ¼</button>
                  <button class="miniBtn" id="btnShare">å…±æœ‰ï¼ˆå¯¾å¿œç«¯æœ«ï¼‰</button>
                </div>
                <div class="toast" id="toast">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</div>
              </div>
            </div>

            <p class="footerNote">ãƒã‚ºã‚Šç”¨Tipsï¼šçµæœã‚«ãƒ¼ãƒ‰ã‚’ã‚¹ã‚¯ã‚·ãƒ§â†’ã€Œå‹é”ã®å‰ä¸–ã‚‚ã‚„ã£ã¦ã¿ã¦ã€ã£ã¦ä¸€è¨€æ·»ãˆã‚‹ã¨å¼·ã„ã€‚</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // æœˆã®ãƒ•ãƒ¬ãƒ¼ã‚º
    const monthMap = {
      1: "è¦‹ãŸç›®ã¯å®Œç’§ãª",
      2: "æ´ã¿ã©ã“ã‚ã®ãªã„",
      3: "çŸ¥æ€§ã‚ãµã‚Œã‚‹",
      4: "ä¸–ç•Œã«ãƒãƒ¬ãŸ",
      5: "ã‚ã–ã¨å¯æ„›ã„",
      6: "å¿ƒãŒãƒã‚«ãƒã‚«ãª",
      7: "é™ã‹ã«æ²¸é¨°ã™ã‚‹",
      8: "å¤ªé™½ã‚ˆã‚Šç›®ç«‹ã¤",
      9: "å¸ã„è¾¼ã¾ã‚Œã‚‹ã‚ˆã†ãª",
      10:"å®ˆã‚ŠãŸããªã‚‹",
      11:"åˆ†æå‹ã®",
      12:"ã‚¯ã‚»å¼·ã‚ãª"
    };

    // æ—¥ã®è‚©æ›¸ï¼ˆâ˜…27æ—¥è¿½åŠ ï¼‰
    const dayMap = {
      1: "ã‚¢ã‚¤ãƒ‰ãƒ«",
      2: "é™½ã‚­ãƒ£",
      3: "ã­ã“",
      4: "ãƒŠãƒ«ã‚·ã‚¹ãƒˆ",
      5: "ãƒ‘ãƒªãƒ”",
      6: "ã‚¸ãƒ§ãƒ¼ã‚¸",
      7: "å¤§è°·ç¿”å¹³",
      8: "ãƒ‘ãƒ³ãƒ€",
      9: "ç¤¾é•·ä»¤å¬¢",
      10:"éœŠ",
      11:"ãƒªãƒ¼ãƒ€ãƒ¼",
      12:"æ­Œæ‰‹",
      13:"ç¥",
      14:"ç¾å°‘å¥³",
      15:"æµ·è³Š",
      16:"å„ªç­‰ç”Ÿ",
      17:"ãƒˆãƒˆãƒ­",
      18:"ä¸€è»",
      19:"å…ˆç”Ÿ",
      20:"å°†è»",
      21:"æ©‹æœ¬ç’°å¥ˆ",
      22:"å¤©ä½¿",
      23:"ã‚¤ã‚±ãƒ¡ãƒ³",
      24:"ãƒãƒ“",
      25:"ã‚¹ãƒˆãƒ¼ã‚«ãƒ¼",
      26:"é­”æ³•ä½¿ã„",
      27:"ãƒ©ã‚¹ãƒœã‚¹",   // â†è¿½åŠ ï¼ˆãƒã‚ºã‚Šæ ï¼‰
      28:"é‡çƒè‹±å­",
      29:"ãƒ‹ãƒ¼ãƒˆ",
      30:"ç‹æ§˜",
      31:"å‹‡è€…"
    };

    const elMonth = document.getElementById("month");
    const elDay = document.getElementById("day");
    const elResult = document.getElementById("resultText");
    const elError = document.getElementById("errorBox");
    const elSound = document.getElementById("soundToggle");

    const elResultCard = document.getElementById("resultCard");
    const elMeta = document.getElementById("metaChips");
    const elShareBox = document.getElementById("shareBox");
    const elShareText = document.getElementById("shareText");
    const elToast = document.getElementById("toast");
    const elHistoryList = document.getElementById("historyList");

    let lastResultText = "";

    // --- åŠ¹æœéŸ³ï¼ˆWebAudioï¼šå¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ä¸è¦ï¼‰ ---
    let audioCtx = null;
    function beep({type="sine", freq=880, duration=0.08, gain=0.08} = {}){
      if (!elSound.checked) return;
      try{
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type;
        o.frequency.value = freq;
        g.gain.value = gain;
        o.connect(g);
        g.connect(audioCtx.destination);
        o.start();
        o.stop(audioCtx.currentTime + duration);
      }catch(e){ /* noop */ }
    }
    function successSound(){
      beep({type:"triangle", freq:740, duration:0.07, gain:0.07});
      setTimeout(()=>beep({type:"triangle", freq:990, duration:0.09, gain:0.06}), 80);
      setTimeout(()=>beep({type:"sine", freq:1320, duration:0.10, gain:0.05}), 170);
    }
    function errorSound(){
      beep({type:"square", freq:220, duration:0.12, gain:0.05});
      setTimeout(()=>beep({type:"square", freq:180, duration:0.14, gain:0.05}), 120);
    }

    function showError(msg){
      elError.style.display = "block";
      elError.textContent = msg;
      errorSound();
    }
    function clearError(){
      elError.style.display = "none";
      elError.textContent = "";
    }

    // --- ãƒã‚ºæ¼”å‡ºï¼šã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼ + ã‚­ãƒ©ãƒƒ ---
    function popSparkle(){
      // ãƒ©ãƒ³ãƒ€ãƒ ä½ç½®ã§å…‰ã‚‰ã›ã‚‹
      const x = Math.floor(Math.random()*70) + 15; // 15%ã€œ85%
      const y = Math.floor(Math.random()*50) + 10; // 10%ã€œ60%
      elResultCard.style.setProperty("--x", x + "%");
      elResultCard.style.setProperty("--y", y + "%");

      elResultCard.classList.remove("pop");
      void elResultCard.offsetWidth; // reflow
      elResultCard.classList.add("pop");
    }

    async function typeText(text, speed=18){
      elResult.textContent = "";
      for (let i=0; i<text.length; i++){
        elResult.textContent += text[i];
        if (i % 6 === 0) beep({type:"sine", freq: 760 + (i%10)*20, duration:0.02, gain:0.02});
        await new Promise(r => setTimeout(r, speed));
      }
    }

    // --- å±¥æ­´ï¼ˆlocalStorageï¼šç›´è¿‘5ä»¶ï¼‰ ---
    const HISTORY_KEY = "zense_history_v1";
    function loadHistory(){
      try{
        const raw = localStorage.getItem(HISTORY_KEY);
        return raw ? JSON.parse(raw) : [];
      }catch{ return []; }
    }
    function saveHistory(list){
      try{ localStorage.setItem(HISTORY_KEY, JSON.stringify(list.slice(0,5))); }catch{}
    }
    function renderHistory(){
      const list = loadHistory();
      elHistoryList.innerHTML = "";
      if (!list.length){
        elHistoryList.innerHTML = "<li>ã¾ã ã‚ã‚Šã¾ã›ã‚“</li>";
        return;
      }
      list.forEach(item=>{
        const li = document.createElement("li");
        li.textContent = item;
        elHistoryList.appendChild(li);
      });
    }
    function pushHistory(text){
      const list = loadHistory();
      const next = [text, ...list.filter(x=>x!==text)];
      saveHistory(next);
      renderHistory();
    }

    function buildShareText(resultText, m, d){
      const hashtag = "#ã‚ãªãŸã®å‰ä¸– #å‰ä¸–è¨ºæ–­ #èª•ç”Ÿæ—¥ #å ã„ #è¨ºæ–­ãƒ¡ãƒ¼ã‚«ãƒ¼";
      // æŠ•ç¨¿ã—ã‚„ã™ã„ã€Œèª˜ã„æ–‡å¥ã€ã‚’æ·»ãˆã‚‹ï¼ˆãƒã‚ºç‹™ã„ï¼‰
      return [
        `ã€ã‚ãªãŸã®å‰ä¸–è¨ºæ–­ã€‘`,
        `èª•ç”Ÿæ—¥ï¼š${m}æœˆ${d}æ—¥`,
        `${resultText}`,
        ``,
        `å‹é”ã®ã‚‚ã‚„ã£ã¦ã¿ã¦â†’ ã“ã®ãƒšãƒ¼ã‚¸ã§æœˆæ—¥å…¥åŠ›ã™ã‚‹ã ã‘`,
        hashtag
      ].join("\n");
    }

    function showToast(msg="ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼"){
      elToast.textContent = msg;
      elToast.classList.add("show");
      setTimeout(()=>elToast.classList.remove("show"), 1400);
    }

    async function copyToClipboard(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        successSound();
      }catch{
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        showToast("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        successSound();
      }
    }

    function validate(m, d){
      if (!m || !d) return "æœˆã¨æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼š7 / 21ï¼‰";
      if (m < 1 || m > 12) return "æœˆã¯1ã€œ12ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
      if (d < 1 || d > 31) return "æ—¥ã¯1ã€œ31ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
      if (!dayMap[d]) return "ãã®æ—¥ã¯ãƒªã‚¹ãƒˆã«ã‚ã‚Šã¾ã›ã‚“ã€‚";
      return "";
    }

    async function judge(){
      clearError();

      const m = Number(elMonth.value);
      const d = Number(elDay.value);

      const err = validate(m, d);
      if (err){
        elMeta.style.display = "none";
        elShareBox.style.display = "none";
        lastResultText = "";
        elResult.textContent = "ã“ã“ã«çµæœãŒå‡ºã¾ã™ã€‚";
        showError(err);
        return;
      }

      const monthWord = monthMap[m];
      const dayWord = dayMap[d];

      const resultText = `ã‚ãªãŸã®å‰ä¸–ã¯ã€ã€${monthWord} ${dayWord}ã§ã™ï¼`;
      lastResultText = resultText;

      // æ¼”å‡º
      popSparkle();
      successSound();
      await typeText(resultText, 16);

      // ãƒ¡ã‚¿æƒ…å ±ï¼ˆã‚¹ã‚¯ã‚·ãƒ§æ˜ ãˆï¼‰
      elMeta.innerHTML = `
        <span class="chip">ğŸ“… ${m}æœˆ${d}æ—¥</span>
        <span class="chip">âœ¨ ${monthWord}</span>
        <span class="chip">ğŸ§© ${dayWord}</span>
      `;
      elMeta.style.display = "flex";

      // æŠ•ç¨¿ç”¨ãƒ†ã‚­ã‚¹ãƒˆ
      elShareText.value = buildShareText(resultText, m, d);
      elShareBox.style.display = "grid";

      pushHistory(resultText);
    }

    function randomPick(){
      clearError();
      const m = Math.floor(Math.random()*12) + 1;
      const days = Object.keys(dayMap).map(Number);
      const d = days[Math.floor(Math.random()*days.length)];
      elMonth.value = m;
      elDay.value = d;
      judge();
    }

    function resetAll(){
      clearError();
      elMonth.value = "";
      elDay.value = "";
      lastResultText = "";
      elResult.textContent = "ã“ã“ã«çµæœãŒå‡ºã¾ã™ã€‚";
      elMeta.style.display = "none";
      elShareBox.style.display = "none";
      elMonth.focus();
      beep({type:"sine", freq:520, duration:0.05, gain:0.04});
    }

    // --- ãƒœã‚¿ãƒ³ ---
    document.getElementById("btnCheck").addEventListener("click", judge);
    document.getElementById("btnRandom").addEventListener("click", randomPick);
    document.getElementById("btnReset").addEventListener("click", resetAll);

    // çµæœã ã‘ã‚³ãƒ”ãƒ¼
    document.getElementById("btnCopyResult").addEventListener("click", () => {
      if (!lastResultText){
        showToast("å…ˆã«è¨ºæ–­ã—ã¦ã­ï¼");
        errorSound();
        return;
      }
      copyToClipboard(lastResultText);
    });

    // æŠ•ç¨¿æ–‡ã‚³ãƒ”ãƒ¼
    document.getElementById("btnCopyShare").addEventListener("click", () => {
      if (!elShareText.value){
        showToast("å…ˆã«è¨ºæ–­ã—ã¦ã­ï¼");
        errorSound();
        return;
      }
      copyToClipboard(elShareText.value);
    });

    // å…±æœ‰ï¼ˆå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ï¼‰
    document.getElementById("btnShare").addEventListener("click", async () => {
      if (!elShareText.value){
        showToast("å…ˆã«è¨ºæ–­ã—ã¦ã­ï¼");
        errorSound();
        return;
      }
      if (navigator.share){
        try{
          await navigator.share({
            title: "ã‚ãªãŸã®å‰ä¸–ãƒ¡ãƒ¼ã‚«ãƒ¼",
            text: elShareText.value
          });
          successSound();
        }catch(e){
          // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãªã©
        }
      }else{
        showToast("ã“ã®ç«¯æœ«ã¯å…±æœ‰ã«æœªå¯¾å¿œã€‚æŠ•ç¨¿æ–‡ã‚³ãƒ”ãƒ¼ã‚’ä½¿ã£ã¦ã­ï¼");
        beep({type:"square", freq:300, duration:0.06, gain:0.03});
      }
    });

    // Enterã‚­ãƒ¼ã§ã‚‚åˆ¤å®š
    [elMonth, elDay].forEach(el => {
      el.addEventListener("keydown", (e) => {
        if (e.key === "Enter") judge();
      });
    });

    renderHistory();
  </script>
</body>
</html>
